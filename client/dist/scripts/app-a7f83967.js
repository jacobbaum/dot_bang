"use strict";angular.module("dotBang",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngResource","ui.router","ngMaterial"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("home",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl"}).state("sequencer",{url:"/sequencer",views:{"":{templateUrl:"app/sequencer/sequencer.html",controller:"SequencerCtrl"},"transport@sequencer":{templateUrl:"app/components/transport/transport.html",controller:"TransportCtrl"},"notation@sequencer":{templateUrl:"app/components/notation/notation.html",controller:"NotationCtrl"},"samples@sequencer":{templateUrl:"app/components/samples/samples.html",controller:"SamplesCtrl"},"controls@sequencer":{templateUrl:"app/components/controls/controls.html",controller:"ControlsCtrl"}}}).state("about",{url:"/about",templateUrl:"app/about/about.html"}),t.otherwise("/")}]),angular.module("dotBang").service("TransportService",["$window",function(){}]),angular.module("dotBang").controller("TransportCtrl",["$scope","$window","NotationService",function(e,t,a){function i(){o.Transport.position="0:0:0",e.position=o.Transport.position}function n(){o.Transport.loopEnd="2:0:0"}function l(t){e.transportState=t,console.log(e.transportState),e.position=o.Transport.position}var o=t.Tone;o.Transport.loop=!0,o.Transport.loopStart="0:0:0",o.Transport.loopEnd="2:0:0",e.bpm=120,e.position=o.Transport.position,e.timeSignature=o.Transport.timeSignature,e.setBpm=function(){o.Transport.bpm.value=e.bpm},e.setTimeSignature=function(){i(),a.changeTimeSignature(e.timeSignature),n()},o.Transport.setInterval(function(){e.$apply(function(){e.position=o.Transport.position})},"16n"),e.play=function(e){o.Transport.start(e),l(o.Transport.state)},e.pause=function(e){o.Transport.pause(e),l(o.Transport.state)},e.stop=function(e){o.Transport.stop(e),o.Transport.position="0:0:0",l(o.Transport.state)},e.back=function(){o.Transport.position="0:0:0","paused"===o.Transport.state&&(e.position=o.Transport.position)}}]),angular.module("dotBang").service("SampleService",function(){var e={name:"rock",samples:[{name:"kick",url:"/app/audio/rock-kit/rock-kick.wav"},{name:"snare",url:"/app/audio/rock-kit/rock-snare.wav"},{name:"open high hat",url:"/app/audio/rock-kit/rock-hh-open.wav"},{name:"closed high hat",url:"/app/audio/rock-kit/rock-hh-closed.wav"},{name:"floor tom",url:"/app/audio/rock-kit/rock-tom-floor.wav"},{name:"rack tom",url:"/app/audio/rock-kit/rock-tom-rack.wav"},{name:"ride cymbal bell",url:"/app/audio/rock-kit/rock-cymbal-ride-bell.wav"},{name:"crash cymbal",url:"/app/audio/rock-kit/rock-cymbal-crash.wav"}]};this.drumCount=e.samples.length,this.drumNames=_.map(e.samples,function(e){return e.name});var t=_.map(e.samples,function(e){var t={};return t[e.name]=e.url,t}),a={};_.forEach(t,function(e){_.merge(a,e)}),this.currentKit=a}),angular.module("dotBang").controller("SamplesCtrl",["$scope","SampleService",function(e,t){e.drumNames=t.drumNames}]),angular.module("dotBang").service("NotationService",function(){function e(){return Tone.Transport.timeSignature===o}function t(){var e=Tone.Transport.timeSignature-o;0>e?a(Math.abs(e)):i(e)}function a(e){var t=l.notation.channels[0].notes.length,a=l.notation.channels[0].notes.length/2,i=4*e,n=t-(i+1),o=a-(i+1);_.forEach(l.notation.channels,function(e){e.notes.splice(n,i).splice(o,i)})}function i(){var e=(l.notation.channels[0].notes.length,l.notation.channels[0].notes.length/2,o);n(e)}function n(e){for(var t=[],a=e;a<Tone.Transport.timeSignature;a++)for(var i=1;5>i;i++){var n=new u(1,a,i," ");t.push(n)}console.log(t)}var l=this;l.notation={name:"demo",timeSignature:"4",channels:[{number:"01",notes:[{time:"0:0:0",value:"."},{time:"0:0:1",value:" "},{time:"0:0:2",value:" "},{time:"0:0:3",value:" "},{time:"0:1:0",value:" "},{time:"0:1:1",value:" "},{time:"0:1:2",value:" "},{time:"0:1:3",value:" "},{time:"0:2:0",value:"."},{time:"0:2:1",value:" "},{time:"0:2:2",value:" "},{time:"0:2:3",value:" "},{time:"0:3:0",value:" "},{time:"0:3:1",value:" "},{time:"0:3:2",value:" "},{time:"0:3:3",value:" "},{time:"1:0:0",value:"."},{time:"1:0:1",value:" "},{time:"1:0:2",value:" "},{time:"1:0:3",value:" "},{time:"1:1:0",value:" "},{time:"1:1:1",value:" "},{time:"1:1:2",value:" "},{time:"1:1:3",value:" "},{time:"1:2:0",value:"."},{time:"1:2:1",value:" "},{time:"1:2:2",value:" "},{time:"1:2:3",value:" "},{time:"1:3:0",value:" "},{time:"1:3:1",value:" "},{time:"1:3:2",value:" "},{time:"1:3:3",value:" "}]},{number:"02",notes:[{time:"0:0:0",value:" "},{time:"0:0:1",value:"."},{time:"0:0:2",value:" "},{time:"0:0:3",value:" "},{time:"0:1:0",value:" "},{time:"0:1:1",value:"."},{time:"0:1:2",value:" "},{time:"0:1:3",value:" "},{time:"0:2:0",value:" "},{time:"0:2:1",value:" "},{time:"0:2:2",value:" "},{time:"0:2:3",value:" "},{time:"0:3:0",value:" "},{time:"0:3:1",value:" "},{time:"0:3:2",value:" "},{time:"0:3:3",value:" "},{time:"1:0:0",value:" "},{time:"1:0:1",value:" "},{time:"1:0:2",value:" "},{time:"1:0:3",value:" "},{time:"1:1:0",value:" "},{time:"1:1:1",value:" "},{time:"1:1:2",value:" "},{time:"1:1:3",value:" "},{time:"1:2:0",value:" "},{time:"1:2:1",value:" "},{time:"1:2:2",value:" "},{time:"1:2:3",value:" "},{time:"1:3:0",value:" "},{time:"1:3:1",value:" "},{time:"1:3:2",value:" "},{time:"1:3:3",value:" "}]},{number:"03",notes:[{time:"0:0:0",value:" "},{time:"0:0:1",value:" "},{time:"0:0:2",value:"."},{time:"0:0:3",value:" "},{time:"0:1:0",value:" "},{time:"0:1:1",value:" "},{time:"0:1:2",value:" "},{time:"0:1:3",value:" "},{time:"0:2:0",value:" "},{time:"0:2:1",value:" "},{time:"0:2:2",value:" "},{time:"0:2:3",value:" "},{time:"0:3:0",value:" "},{time:"0:3:1",value:" "},{time:"0:3:2",value:" "},{time:"0:3:3",value:" "},{time:"1:0:0",value:" "},{time:"1:0:1",value:" "},{time:"1:0:2",value:" "},{time:"1:0:3",value:" "},{time:"1:1:0",value:" "},{time:"1:1:1",value:" "},{time:"1:1:2",value:" "},{time:"1:1:3",value:" "},{time:"1:2:0",value:" "},{time:"1:2:1",value:" "},{time:"1:2:2",value:" "},{time:"1:2:3",value:" "},{time:"1:3:0",value:"."},{time:"1:3:1",value:" "},{time:"1:3:2",value:" "},{time:"1:3:3",value:" "}]},{number:"04",notes:[{time:"0:0:0",value:" "},{time:"0:0:1",value:" "},{time:"0:0:2",value:" "},{time:"0:0:3",value:" "},{time:"0:1:0",value:" "},{time:"0:1:1",value:" "},{time:"0:1:2",value:" "},{time:"0:1:3",value:"."},{time:"0:2:0",value:" "},{time:"0:2:1",value:" "},{time:"0:2:2",value:" "},{time:"0:2:3",value:" "},{time:"0:3:0",value:" "},{time:"0:3:1",value:" "},{time:"0:3:2",value:" "},{time:"0:3:3",value:" "},{time:"1:0:0",value:" "},{time:"1:0:1",value:" "},{time:"1:0:2",value:" "},{time:"1:0:3",value:" "},{time:"1:1:0",value:" "},{time:"1:1:1",value:" "},{time:"1:1:2",value:" "},{time:"1:1:3",value:" "},{time:"1:2:0",value:" "},{time:"1:2:1",value:" "},{time:"1:2:2",value:" "},{time:"1:2:3",value:"."},{time:"1:3:0",value:" "},{time:"1:3:1",value:" "},{time:"1:3:2",value:" "},{time:"1:3:3",value:" "}]},{number:"05",notes:[{time:"0:0:0",value:" "},{time:"0:0:1",value:" "},{time:"0:0:2",value:" "},{time:"0:0:3",value:" "},{time:"0:1:0",value:" "},{time:"0:1:1",value:" "},{time:"0:1:2",value:" "},{time:"0:1:3",value:" "},{time:"0:2:0",value:" "},{time:"0:2:1",value:" "},{time:"0:2:2",value:"."},{time:"0:2:3",value:"."},{time:"0:3:0",value:" "},{time:"0:3:1",value:" "},{time:"0:3:2",value:" "},{time:"0:3:3",value:" "},{time:"1:0:0",value:" "},{time:"1:0:1",value:" "},{time:"1:0:2",value:" "},{time:"1:0:3",value:" "},{time:"1:1:0",value:" "},{time:"1:1:1",value:" "},{time:"1:1:2",value:" "},{time:"1:1:3",value:" "},{time:"1:2:0",value:" "},{time:"1:2:1",value:" "},{time:"1:2:2",value:" "},{time:"1:2:3",value:" "},{time:"1:3:0",value:" "},{time:"1:3:1",value:" "},{time:"1:3:2",value:" "},{time:"1:3:3",value:" "}]},{number:"06",notes:[{time:"0:0:0",value:" "},{time:"0:0:1",value:" "},{time:"0:0:2",value:" "},{time:"0:0:3",value:" "},{time:"0:1:0",value:" "},{time:"0:1:1",value:" "},{time:"0:1:2",value:" "},{time:"0:1:3",value:"."},{time:"0:2:0",value:" "},{time:"0:2:1",value:" "},{time:"0:2:2",value:" "},{time:"0:2:3",value:" "},{time:"0:3:0",value:" "},{time:"0:3:1",value:" "},{time:"0:3:2",value:" "},{time:"0:3:3",value:" "},{time:"1:0:0",value:" "},{time:"1:0:1",value:" "},{time:"1:0:2",value:" "},{time:"1:0:3",value:" "},{time:"1:1:0",value:" "},{time:"1:1:1",value:"."},{time:"1:1:2",value:" "},{time:"1:1:3",value:" "},{time:"1:2:0",value:" "},{time:"1:2:1",value:" "},{time:"1:2:2",value:" "},{time:"1:2:3",value:" "},{time:"1:3:0",value:" "},{time:"1:3:1",value:" "},{time:"1:3:2",value:" "},{time:"1:3:3",value:" "}]},{number:"07",notes:[{time:"0:0:0",value:" "},{time:"0:0:1",value:" "},{time:"0:0:2",value:" "},{time:"0:0:3",value:" "},{time:"0:1:0",value:" "},{time:"0:1:1",value:" "},{time:"0:1:2",value:" "},{time:"0:1:3",value:" "},{time:"0:2:0",value:"."},{time:"0:2:1",value:" "},{time:"0:2:2",value:" "},{time:"0:2:3",value:" "},{time:"0:3:0",value:"."},{time:"0:3:1",value:" "},{time:"0:3:2",value:" "},{time:"0:3:3",value:" "},{time:"1:0:0",value:"."},{time:"1:0:1",value:" "},{time:"1:0:2",value:" "},{time:"1:0:3",value:" "},{time:"1:1:0",value:"."},{time:"1:1:1",value:" "},{time:"1:1:2",value:" "},{time:"1:1:3",value:" "},{time:"1:2:0",value:" "},{time:"1:2:1",value:" "},{time:"1:2:2",value:" "},{time:"1:2:3",value:" "},{time:"1:3:0",value:" "},{time:"1:3:1",value:" "},{time:"1:3:2",value:" "},{time:"1:3:3",value:" "}]},{number:"08",notes:[{time:"0:0:0",value:"."},{time:"0:0:1",value:" "},{time:"0:0:2",value:" "},{time:"0:0:3",value:" "},{time:"0:1:0",value:" "},{time:"0:1:1",value:" "},{time:"0:1:2",value:" "},{time:"0:1:3",value:" "},{time:"0:2:0",value:" "},{time:"0:2:1",value:" "},{time:"0:2:2",value:" "},{time:"0:2:3",value:" "},{time:"0:3:0",value:" "},{time:"0:3:1",value:" "},{time:"0:3:2",value:" "},{time:"0:3:3",value:" "},{time:"1:0:0",value:"."},{time:"1:0:1",value:" "},{time:"1:0:2",value:" "},{time:"1:0:3",value:" "},{time:"1:1:0",value:" "},{time:"1:1:1",value:" "},{time:"1:1:2",value:" "},{time:"1:1:3",value:" "},{time:"1:2:0",value:" "},{time:"1:2:1",value:" "},{time:"1:2:2",value:" "},{time:"1:2:3",value:" "},{time:"1:3:0",value:" "},{time:"1:3:1",value:" "},{time:"1:3:2",value:" "},{time:"1:3:3",value:" "}]}]},l.channelCount=l.notation.channels.length,Tone.Transport.timeSignature=parseInt(l.notation.timeSignature,10);var o=parseInt(l.notation.timeSignature,10),u=function(e,t,a,i){this.time=e+":"+t+":"+a,this.value=i};this.changeTimeSignature=function(a){Tone.Transport.timeSignature=a,e()||t()}}),angular.module("dotBang").controller("NotationCtrl",["$scope","$timeout","$window","NotationService",function(e,t,a,i){var n=a.Tone,l=a._;e.notation=i.notation,e.clearNotes=function(){l.forEach(e.notation.channels,function(e){l.forEach(e.notes,function(e){e.value=" "})})},e.cycleNotes=function(e){var t=[" ",".","!"],a=t.indexOf(e.value);a++,a===t.length&&(a=0),e.value=t[a]},e.beatBoundary=function(e){return(e+1)%4===0};var o=(i.channelCount,0);n.Transport.setInterval(function(){e.noteOn=function(e,t){return" "!==e.value&&t===o},o++,o%=8*n.Transport.timeSignature},"16n")}]),angular.module("dotBang").controller("NavbarCtrl",["$scope",function(e){e.date=new Date}]),angular.module("dotBang").controller("ControlsCtrl",["$scope",function(){}]),angular.module("dotBang").controller("SequencerCtrl",["$scope","$window","NotationService","SampleService",function(e,t,a,i){var n=t.Tone,l={volume:-15},o={volume:-10},u=i.drumCount,r=i.drumNames,m=i.currentKit,s=a.notation,v=0,p=new n.PolySynth(u,n.Sampler,m).toMaster();p.set(l);var c=new n.PolySynth(u,n.Sampler,m).toMaster();c.set(o),n.Transport.setInterval(function(e){for(var t=0;u>t;t++)"."===s.channels[t].notes[v].value?p.triggerAttack(r[t],e):"!"===s.channels[t].notes[v].value&&c.triggerAttack(r[t],e);v++,v%=8*n.Transport.timeSignature},"16n")}]),angular.module("dotBang").controller("MainCtrl",["$scope",function(e){e.awesomeThings=[{title:"AngularJS",url:"https://angularjs.org/",description:"HTML enhanced for web apps!",logo:"angular.png"},{title:"BrowserSync",url:"http://browsersync.io/",description:"Time-saving synchronised browser testing.",logo:"browsersync.png"},{title:"GulpJS",url:"http://gulpjs.com/",description:"The streaming build system.",logo:"gulp.png"},{title:"Jasmine",url:"http://jasmine.github.io/",description:"Behavior-Driven JavaScript.",logo:"jasmine.png"},{title:"Karma",url:"http://karma-runner.github.io/",description:"Spectacular Test Runner for JavaScript.",logo:"karma.png"},{title:"Protractor",url:"https://github.com/angular/protractor",description:"End to end test framework for AngularJS applications built on top of WebDriverJS.",logo:"protractor.png"},{title:"Angular Material Design",url:"https://material.angularjs.org/#/",description:"The Angular reference implementation of the Google's Material Design specification.",logo:"angular-material.png"},{title:"Sass (Node)",url:"https://github.com/sass/node-sass",description:"Node.js binding to libsass, the C version of the popular stylesheet preprocessor, Sass.",logo:"node-sass.png"}],angular.forEach(e.awesomeThings,function(e){e.rank=Math.random()})}]),angular.module("dotBang").run(["$templateCache",function(e){e.put("app/main/main.html",'<div layout="vertical" layout-fill=""><md-content><section class="jumbotron"><h1>\'Allo, \'Allo!</h1><p class="lead"><img src="assets/images/yeoman.png" alt="I\'m Yeoman"><br>Always a pleasure scaffolding your apps.</p><p><a class="btn" ng-href="#">Splendid!</a></p></section><div class="techs" layout-align="center"><md-card ng-repeat="awesomeThing in awesomeThings | orderBy:\'rank\'"><div class="thumbnail"><img class="pull-right" ng-src="assets/images/{{awesomeThing.logo}}" alt="{{awesomeThing.title}}"><div class="caption"><h3>{{awesomeThing.title}}</h3><p>{{awesomeThing.description}}</p><p><a ng-href="{{awesomeThing.url}}">{{awesomeThing.url}}</a></p></div></div></md-card></div><footer><md-toolbar layout="row" layout-align="center center"><p>With ♥ from <a href="https://twitter.com/Swiip">@Swiip</a></p></md-toolbar></footer></md-content></div>'),e.put("app/sequencer/sequencer.html",'<h3>Sequencer</h3><div ui-view="transport"></div><div layout="row"><div ui-view="samples" flex="20"></div><div ui-view="notation" flex="80"></div></div><div ui-view="controls"></div>'),e.put("app/components/controls/controls.html","<h3>Controls</h3>"),e.put("app/components/navbar/navbar.html",'<md-toolbar layout="row" layout-align="center center" ng-controller="NavbarCtrl"><md-button href="https://github.com/Swiip/generator-gulp-angular">Gulp Angular</md-button><section flex="" layout="row" layout-align="left center"><md-button href="#" class="md-raised">Home</md-button><md-button href="#" class="md-raised">About</md-button><md-button href="#" class="md-raised">Contact</md-button></section><md-button href="#">Current date: {{ date | date:\'yyyy-MM-dd\' }}</md-button></md-toolbar>'),e.put("app/components/notation/notation.html",'<h3>Notation</h3><div ng-repeat="channel in notation.channels track by $index" ng-init="chanIndex = $index" layout="column" layout-margin=""><div class="fixed-height" layout="row" layout-align="space-around center"><div ng-repeat="note in channel.notes track by $index" ng-init="noteIndex = $index" class="note" ng-class="{\'beat-boundary\': (!$last && beatBoundary(noteIndex))}" flex=""><md-input-container><input type="button" value="{{ note.value }}" ng-model="note" ng-click="cycleNotes(note, chanIndex)" ng-class="{\'note-on\': noteOn(note, noteIndex)}" class="animated fadeIn"></md-input-container></div></div></div><md-button ng-click="clearNotes()">Clear Notes</md-button>'),e.put("app/components/samples/samples.html",'<h3>Samples</h3><div ng-repeat="name in drumNames" layout="column" layout-margin=""><div class="fixed-height" layout="row" layout-align="end center">{{ name }}</div></div>'),e.put("app/components/transport/transport.html",'<h3>Transport</h3><div layout="row" layout-margin=""><md-button class="md-button transport-button" aria-label="Play" ng-click="play()"><i class="fa fa-play fa-2x"></i></md-button><md-button class="md-button transport-button" aria-label="Pause" ng-click="pause()"><i class="fa fa-pause fa-2x"></i></md-button><md-button class="md-button transport-button" aria-label="Stop" ng-click="back()"><i class="fa fa-step-backward fa-2x"></i></md-button><md-input-container><label>bpm</label> <input required="" type="number" step="any" name="bpm" ng-model="bpm" ng-change="setBpm()" min="1" max="300"></md-input-container><md-input-container><label>time signature</label> <input required="" type="number" step="any" name="timeSignature" ng-model="timeSignature" ng-change="setTimeSignature()" min="1" max="11"></md-input-container><div>bpm : {{ bpm }}</div><div>time signature : {{ timeSignature }}/4</div><div>bars:beats:16ths : {{ position }}</div><div>{{ transportState }}</div></div>')}]);